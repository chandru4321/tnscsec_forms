<!-- ACTION BUTTONS -->
<div class="table-actions">
  <!-- <button [routerLink]="['/layout/form1to10/form1']" [queryParams]="{id:r.id}">
    Edit
  </button> -->



  <tr *ngFor="let r of tableRows">

    <!-- your other <td> columns -->

    <td *ngIf="r.rowSpan">
      <button class="action-btn edit-btn" [routerLink]="['/layout/form1to10/form1']" [queryParams]="{ id: r.id }">
        Edit
      </button>
    </td>


  </tr>

















  <!-- (click)="onEdit() -->
  <button class="action-btn export-btn" (click)="exportToExcel()">⬇️ Export Excel</button>
</div>

<!-- TABLE SCROLL AREA -->
<div class="table-scroll-wrapper">

  <table class="report-table" id="reportTable">

    <thead>

      <!-- TOP HEADER -->
      <tr class="top-header">
        <th colspan="13">
          மாவட்ட தேர்தல் அலுவலரால் தேர்தல் அறிவிப்பு வழங்கப்பட்ட விவரம்
        </th>
      </tr>

      <!-- SUB HEADER -->
      <tr class="top-sub-header">
        <th colspan="13">
          துறை--கூட்டுறவு சங்கங்களின் பதிவாளர் (விவரம்)(department_name)
        </th>
      </tr>

      <!-- MAIN HEADER -->
      <tr>
        <th rowspan="2">வ.எண்</th>
        <th rowspan="2"><br><br>மாவட்டம்(district_name)</th>
        <th rowspan="2"><br>மாவட்ட தேர்தல் அலுவலர் சரகம்(zone_name)</th>
        <th rowspan="2">
          தேர்தல் அறிவிப்பதற்கு<br>
          திட்டமிடப்பட்ட சங்கங்களின் எண்ணிக்கை(masterzone_count)
        </th>

        <th rowspan="2" class="wrap-col">
          தேர்தல் ஆணையத்தால் திட்டம் வழங்கப்பட்ட<br>
          சங்கங்களின் பெயர்(masterzone societies)
        </th>

        <th rowspan="2" class="wrap-col">
          தேர்தல் அறிவிப்பு வழங்கப்பட்ட<br>
          சங்கங்களின் பெயர்(selected_soc_names)
        </th>

        <th colspan="4">
          நிர்வாகக்குழு உறுப்பினர்களின் எண்ணிக்கை
        </th>

        <th rowspan="2" class="wrap-col">
          தேர்தல் அறிவிப்பு வழங்கப்படாத<br>
          சங்கங்களின் பெயர்(non_selected_societies)
        </th>

        <th rowspan="2">வழங்கப்படாத<br> சங்கங்களின் எண்ணிக்கை</th>
        <th rowspan="2">குறிப்பு(remark)</th>
      </tr>

      <tr class="sub-header">
        <th>ப.ச / ப.கு (sc_st)</th>
        <th>மகளிர்(women)</th>
        <th>பொது(general)</th>
        <th>மொத்தம்(tot_voters)</th>
      </tr>

    </thead>

    <tbody>

      <tr *ngFor="let r of tableRows; let i = index">

        <!-- SERIAL (ONCE) -->
        <td *ngIf="r.rowSpan" [attr.rowspan]="r.rowSpan">
          {{ i + 1 }}
        </td>

        <!-- DISTRICT (ONCE) -->
        <td *ngIf="r.rowSpan" [attr.rowspan]="r.rowSpan">
          {{ r.district_name }}
        </td>

        <!-- ZONE (ONCE) -->
        <td *ngIf="r.rowSpan" [attr.rowspan]="r.rowSpan">
          {{ r.zone_name }}
        </td>

        <!-- MASTERZONE COUNT (ONCE) -->
        <td *ngIf="r.rowSpan" [attr.rowspan]="r.rowSpan">
          {{ r.masterzone_count }}
        </td>

        <!-- MASTERZONE SOCIETY -->
        <td class="text-left wrap-col">
          {{ r.society_name }}
        </td>

        <!-- SELECTED SOCIETY -->
        <td class="text-left wrap-col">
          {{ r.isSelected ? r.society_name : '-' }}
        </td>

        <!-- NUMBERS -->
        <td>{{ r.sc_st ?? '' }}</td>
        <td>{{ r.women ?? '' }}</td>
        <td>{{ r.general ?? '' }}</td>
        <td class="total-cell">{{ r.tot_voters ?? '' }}</td>

        <!-- NON SELECTED SOCIETY -->
        <td class="danger-text wrap-col">
          {{ r.isSelected ? '-' : r.society_name }}
        </td>

        <!-- NON SELECTED COUNT (ONCE) -->
        <td *ngIf="r.rowSpan" [attr.rowspan]="r.rowSpan">
          {{ r.non_selected_count }}
        </td>

        <!-- REMARK (ONCE) -->
        <td *ngIf="r.rowSpan" [attr.rowspan]="r.rowSpan" class="note-cell">
          {{ r.remark }}
        </td>

      </tr>

    </tbody>

  </table>
</div>
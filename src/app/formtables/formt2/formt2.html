<div class="table-actions">
    <button class="action-btn export-btn" (click)="exportToExcel()">
        ⬇ Export Excel
    </button>
</div>



<div class="table-scroll-wrapper">

    <table class="report-table" id="reportTable">

        <thead>

            <!-- TOP HEADER -->
            <tr class="top-header">
                <th colspan="8">
                    சங்கம் உறுப்பினர் பட்டியல் வெளியிடுதல் மற்றும் வாக்காளர் பட்டியல் அலுவலருக்கு உறுப்பினர் பட்டியல்
                    அளித்த/அளிக்காத சங்கங்கள் விவரம் </th>
            </tr>
            <!-- SUB HEADER -->
            <tr class="top-sub-header">
                <th colspan="13">
                    துறை -- {{ department_name }}
                </th>
            </tr>


            <!-- MAIN HEADER -->
            <tr>
                <th>மாவட்ட தேர்தல் அலுவலர் மாவட்டம்/மண்டலம்</th>
                <th>மாவட்ட தேர்தல் அலுவலர் சரகம்</th>

                <th class="wrap-col">
                    Form-1 ல் தேர்வு செய்யப்பட்ட சங்கங்கள் (F3)
                </th>

                <th class="wrap-col">
                    உறுப்பினர் பட்டியல் அளித்த சங்கங்கள் (F5)
                </th>

                <th class="wrap-col">
                    உறுப்பினர் பட்டியல் அளிக்காத சங்கங்கள் (F6)
                </th>

                <th>
                    அளிக்காத சங்கங்களின் எண்ணிக்கை
                </th>

                <th>குறிப்பு</th>
            </tr>

        </thead>

        <tbody>

            <tr *ngFor="let r of tableRows">

                <!-- District -->
                <td *ngIf="r.rowSpan" [attr.rowspan]="r.rowSpan">
                    {{ r.district_name }}
                </td>

                <!-- Zone -->
                <td *ngIf="r.rowSpan" [attr.rowspan]="r.rowSpan">
                    {{ r.zone_name }}
                </td>

                <!-- F3 -->
                <td class="wrap-col text-left">
                    {{ r.f3_name || '-' }}
                </td>

                <!-- F5 -->
                <td class="wrap-col text-left total-cell">
                    {{ r.f5_name || '-' }}
                </td>

                <!-- F6 -->
                <td class="wrap-col text-left danger-text">
                    {{ r.f6_name || '-' }}
                </td>

                <!-- Count -->
                <td *ngIf="r.rowSpan" [attr.rowspan]="r.rowSpan">
                    {{ r.non_selected_count }}
                </td>

                <!-- Remark -->
                <td *ngIf="r.rowSpan" [attr.rowspan]="r.rowSpan" class="note-cell">
                    {{ r.remark }}
                </td>

            </tr>

        </tbody>


    </table>

</div>
<div class="page-content">
    <div class="table-actions">
        <button class="action-btn export-btn" (click)="exportToExcel()">
            ⬇ Export Excel
        </button>
    </div>

    <div class="table-scroll-wrapper">
        <table class="report-table" id="reportTable">

            <thead>

                <!-- TITLE -->
                <tr class="top-header">
                    <th colspan="32">
                        வேட்புமனு திரும்ப பெறுதல் மற்றும் இறுதி போட்டியிடும் வேட்பாளர்கள் பற்றிய முழு விவரங்கள்
                    </th>
                </tr>

                <!-- DEPARTMENT -->
                <tr class="top-sub-header">
                    <th colspan="32">
                        துறை -- {{ department_name }}
                    </th>
                </tr>

                <!-- HEADER LEVEL 1 -->
                <tr class="main-header">
                    <th rowspan="2" class="col-small">வ.எண்</th>
                    <th rowspan="2" class="col-medium">மாவட்டம்</th>
                    <th rowspan="2" class="col-medium">சரகம்</th>
                    <th rowspan="2" class="col-wide">சங்கம்</th>

                    <!-- Withdrawal Names -->
                    <th colspan="3">செல்லத்தக்க வேட்புமனுக்கள் பட்டியல்படி திரும்பப் பெற்ற வேட்புமனுக்களின்
                        உறுப்பினர்களின்
                        பெயர்(f1)</th>

                    <!-- Withdrawal Count -->
                    <th colspan="4">செல்லத்தக்க வேட்புமனுக்கள் பட்டியல்படி திரும்பப் பெற்ற வேட்புமனுக்களின்
                        எண்ணிக்கை(f1-count)</th>

                    <!-- Final Names -->
                    <th colspan="3">ரபோட்டியிடும் வேட்பாளர் இறுதி பட்டியலின்படி தேர்தலில் போட்டியிடும் வேட்பாளர்களின்
                        பெயர்(f2)</th>

                    <!-- Final Count -->
                    <th colspan="4">போட்டியிடும் வேட்பாளர் இறுதி பட்டியலின்படி தேர்தலில் போட்டியிடும் வேட்பாளர்களின்
                        எண்ணிக்கை(f2-count)</th>

                    <!-- Equal Case Names -->
                    <th colspan="3">செல்லத்தக்க வேட்புமனுக்கள் பட்டியல்படி போட்டியிடும் வேட்பாளர்களின் எண்ணிக்கையானது
                        நிர்வாகக் குழுவிற்கு தேர்ந்தெடுக்க வேண்டிய உறுப்பினர்களின் எண்ணிக்கைக்கு சமமாக இருந்து தேர்தலில்
                        போட்டியில்லாத சங்க உறுப்பினர்களின் பெயர் (சமம்)(f3)</th>

                    <!-- Equal Case Count -->
                    <th colspan="4">செல்லத்தக்க வேட்புமனுக்கள் பட்டியல்படி போட்டியிடும் வேட்பாளர்களின் எண்ணிக்கையானது
                        நிர்வாகக் குழுவிற்கு தேர்ந்தெடுக்க வேண்டிய உறுப்பினர்களின் எண்ணிக்கைக்கு சமமாக இருந்து தேர்தலில்
                        போட்டியில்லாத சங்க உறுப்பினர்களின் எண்ணிக்கை(f3-count)</th>

                    <!-- Less Case Names -->
                    <th colspan="3">செல்லத்தக்க வேட்புமனுக்கள் பட்டியல்படி போட்டியிடும் வேட்பாளர்களின் எண்ணிக்கையானது
                        நிர்வாகக் குழுவிற்கு தேர்ந்தெடுக்க வேண்டிய உறுப்பினர்களின் எண்ணிக்கைக்கு குறைவாக இருந்து
                        தேர்தலில்
                        போட்டியில்லாத சங்க உறுப்பினர்களின் பெயர்(f4)</th>

                    <!-- Less Case Count -->
                    <th colspan="4">செல்லத்தக்க வேட்புமனுக்கள் பட்டியல்படி போட்டியிடும் வேட்பாளர்களின் எண்ணிக்கையானது
                        நிர்வாகக் குழுவிற்கு தேர்ந்தெடுக்க வேண்டிய உறுப்பினர்களின் எண்ணிக்கைக்கு குறைவாக இருந்து
                        தேர்தலில்
                        போட்டியில்லாத சங்க உறுப்பினர்களின் எண்ணிக்கை(f4-count)</th>
                    <th colspan="3">செல்லத்தக்க வேட்புமனுக்கள் பட்டியலின்படி போட்டியிடக்கூடிய சங்கங்களின் நிர்வாகக் குழு
                        உறுப்பினர்கள்(f5)</th>
                    <th colspan="4">செல்லத்தக்க வேட்புமனுக்கள் பட்டியலின்படி போட்டியிடக்கூடிய சங்கங்களின் நிர்வாகக் குழு
                        உறுப்பினர்கள் எண்ணிக்கை(f5-count)</th>
                </tr>

                <!-- HEADER LEVEL 2 -->
                <tr class="sub-header">

                    <!-- Withdrawal Names -->
                    <th>SC/ST</th>
                    <th>பெண்கள்</th>
                    <th>பொது</th>

                    <!-- Withdrawal Count -->
                    <th>SC/ST</th>
                    <th>பெண்கள்</th>
                    <th>பொது</th>
                    <th>மொத்தம்</th>

                    <!-- Final Names -->
                    <th>SC/ST</th>
                    <th>பெண்கள்</th>
                    <th>பொது</th>

                    <!-- Final Count -->
                    <th>SC/ST</th>
                    <th>பெண்கள்</th>
                    <th>பொது</th>
                    <th>மொத்தம்</th>

                    <!-- Equal Names -->
                    <th>SC/ST</th>
                    <th>பெண்கள்</th>
                    <th>பொது</th>

                    <!-- Equal Count -->
                    <th>SC/ST</th>
                    <th>பெண்கள்</th>
                    <th>பொது</th>
                    <th>மொத்தம்</th>

                    <!-- Less Names -->
                    <th>SC/ST</th>
                    <th>பெண்கள்</th>
                    <th>பொது</th>

                    <!-- Less Count -->
                    <th>SC/ST</th>
                    <th>பெண்கள்</th>
                    <th>பொது</th>
                    <th>மொத்தம்</th>

                    <th>SC/ST</th>
                    <th>பெண்கள்</th>
                    <th>பொது</th>

                    <th>SC/ST</th>
                    <th>பெண்கள்</th>
                    <th>பொது</th>
                    <th>மொத்தம்</th>

                </tr>

            </thead>

            <tbody>

                <tr *ngFor="let r of tableRows; let i = index">

                    <td>{{ i + 1 }}</td>

                    <td *ngIf="r.rowSpan" [attr.rowspan]="r.rowSpan">
                        {{ r.district_name }}
                    </td>

                    <td *ngIf="r.rowSpan" [attr.rowspan]="r.rowSpan">
                        {{ r.zone_name }}
                    </td>

                    <td class="text-left col-wide">
                        {{ r.society_name }}
                    </td>

                    <!-- Withdrawal Names -->
                    <td>{{ r.w_sc_name }}</td>
                    <td>{{ r.w_women_name }}</td>
                    <td>{{ r.w_general_name }}</td>

                    <!-- Withdrawal Count -->
                    <td>{{ r.w_sc }}</td>
                    <td>{{ r.w_women }}</td>
                    <td>{{ r.w_general }}</td>
                    <td>{{ r.w_total }}</td>

                    <!-- Final Names -->
                    <td>{{ r.f_sc_name }}</td>
                    <td>{{ r.f_women_name }}</td>
                    <td>{{ r.f_general_name }}</td>

                    <!-- Final Count -->
                    <td>{{ r.f_sc }}</td>
                    <td>{{ r.f_women }}</td>
                    <td>{{ r.f_general }}</td>
                    <td>{{ r.f_total }}</td>

                    <!-- Equal Names -->
                    <td>{{ r.eq_sc_name }}</td>
                    <td>{{ r.eq_women_name }}</td>
                    <td>{{ r.eq_general_name }}</td>

                    <!-- Equal Count -->
                    <td>{{ r.eq_sc }}</td>
                    <td>{{ r.eq_women }}</td>
                    <td>{{ r.eq_general }}</td>
                    <td>{{ r.eq_total }}</td>

                    <!-- Less Names -->
                    <td>{{ r.less_sc_name }}</td>
                    <td>{{ r.less_women_name }}</td>
                    <td>{{ r.less_general_name }}</td>

                    <!-- Less Count -->
                    <td>{{ r.less_sc }}</td>
                    <td>{{ r.less_women }}</td>
                    <td>{{ r.less_general }}</td>
                    <td>{{ r.less_total }}</td>

                    <!-- F5 Names -->
                    <td>{{ r.final_sc_name }}</td>
                    <td>{{ r.final_women_name }}</td>
                    <td>{{ r.final_general_name }}</td>

                    <!-- F5 Count -->
                    <td>{{ r.final_sc }}</td>
                    <td>{{ r.final_women }}</td>
                    <td>{{ r.final_general }}</td>
                    <td>{{ r.final_total }}</td>


                </tr>

            </tbody>

        </table>
    </div>
</div>